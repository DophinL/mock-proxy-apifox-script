function h(o,a){if(!Array.isArray(o)||typeof a!="function")throw new Error("Invalid arguments. Expected an array and a function.");let e=[],r=[];for(let i of o)a(i)?e.push(i):r.push(i);return[e,r]}var A="https://app.apifox.com",f=(o,a)=>{let{projectConfig:e}=o;return a.fetchJSON(`${A}/api/v1/api-tree-list?locale=zh-CN`,{headers:{"X-Project-Id":`${e.id}`,Authorization:e==null?void 0:e.bearerToken,"X-Client-Version":e==null?void 0:e.clientVersion}}).then(r=>{let i=[],c=[],d=s=>{var t;let n=((t=e.requestMap)==null?void 0:t[s.path])||s.path;return{id:s.id,name:s.name,method:s.method.toUpperCase(),path:s.path,realPath:n,creator:`${s.responsibleId}`,mockUrl:`${e==null?void 0:e.mockPrefixUrl}/${s.path}`,sourceUrl:`${A}/project/${e==null?void 0:e.id}/apis/api-${s==null?void 0:s.id}`,creatorId:s.responsibleId}},u=(s,n="")=>{if(s.type!=="apiDetailFolder"||!s.children||s.children.length===0)return;let[t,l]=h(s.children||[],p=>p.type==="apiDetail");if(t.length>0){let p=t.map(m=>d(m.api));c.push(...p),i.push({id:s.key,name:n?`${n}__${s.name}`:s.name,apis:p})}l.forEach(p=>{u(p,s.name)})};return r.data.forEach(s=>{u(s)}),{groups:[{id:"all",name:"\u5168\u90E8\u63A5\u53E3",apis:c},...i]}})},x=async(o,a)=>{var s,n;let{projectConfig:e,overviewApiResponse:r}=o,c=(await a.fetchJSON(`${A}/api/v1/api-mocks?locale=zh-CN`,{headers:{"X-Project-Id":`${e.id}`,Authorization:e==null?void 0:e.bearerToken,"X-Client-Version":e==null?void 0:e.clientVersion}})).data.filter(t=>t.apiDetailId===r.id).map(t=>({id:t.id,name:t.name,mockUrl:`${e==null?void 0:e.mockPrefixUrl}/${r.path}`,mockData:JSON.parse(t.response.bodyData)})),d=((s=e.requestMap)==null?void 0:s[r.url])||r.url;return{id:r.id,name:r.name,method:r.method,path:r.url,realPath:d,creator:`${r.creatorId}`,mockUrl:`${e==null?void 0:e.mockPrefixUrl}/${r.path}`,sourceUrl:`${A}/project/${e==null?void 0:e.id}/apis/api-${r==null?void 0:r.id}`,mockData:((n=c[0])==null?void 0:n.mockData)||{},scenes:c,creatorId:r.creatorId}};export{x as getApi,f as getProject};
