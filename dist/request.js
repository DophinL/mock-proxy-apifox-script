function h(o,a){if(!Array.isArray(o)||typeof a!="function")throw new Error("Invalid arguments. Expected an array and a function.");let e=[],t=[];for(let i of o)a(i)?e.push(i):t.push(i);return[e,t]}var A="https://app.apifox.com",f=(o,a)=>{let{projectConfig:e}=o;return a.fetchJSON(`${A}/api/v1/api-tree-list?locale=zh-CN`,{headers:{"X-Project-Id":`${e.id}`,Authorization:e==null?void 0:e.bearerToken,"X-Client-Version":e==null?void 0:e.clientVersion}}).then(t=>{let i=[],c=[],d=s=>{var r;let n=((r=e.requestMap)==null?void 0:r[s.path])||s.path;return{id:s.id,name:s.name,method:s.method.toUpperCase(),path:s.path,realPath:n,creator:`${s.responsibleId}`,mockUrl:`${e==null?void 0:e.mockPrefixUrl}${s.path}`,sourceUrl:`${A}/project/${e==null?void 0:e.id}/apis/api-${s==null?void 0:s.id}`,creatorId:s.responsibleId}},u=(s,n="")=>{if(s.type!=="apiDetailFolder"||!s.children||s.children.length===0)return;let[r,l]=h(s.children||[],p=>p.type==="apiDetail");if(r.length>0){let p=r.map(m=>d(m.api));c.push(...p),i.push({id:s.key,name:n?`${n}__${s.name}`:s.name,apis:p})}l.forEach(p=>{u(p,s.name)})};return t.data.forEach(s=>{u(s)}),{groups:[{id:"all",name:"\u5168\u90E8\u63A5\u53E3",apis:c},...i]}})},x=async(o,a)=>{var s,n;let{projectConfig:e,overviewApiResponse:t}=o,c=(await a.fetchJSON(`${A}/api/v1/api-mocks?locale=zh-CN`,{headers:{"X-Project-Id":`${e.id}`,Authorization:e==null?void 0:e.bearerToken,"X-Client-Version":e==null?void 0:e.clientVersion}})).data.filter(r=>r.apiDetailId===t.id).map((r,l)=>({id:l===0?"default":r.id,name:r.name,mockUrl:`${e==null?void 0:e.mockPrefixUrl}${t.path}`,mockData:JSON.parse(r.response.bodyData)})),d=((s=e.requestMap)==null?void 0:s[t.path])||t.path;return{id:t.id,name:t.name,method:t.method,path:t.path,realPath:d,creator:`${t.creatorId}`,mockUrl:`${e==null?void 0:e.mockPrefixUrl}${t.path}`,sourceUrl:`${A}/project/${e==null?void 0:e.id}/apis/api-${t==null?void 0:t.id}`,mockData:((n=c[0])==null?void 0:n.mockData)||{},scenes:c,creatorId:t.creatorId}};export{x as getApi,f as getProject};
